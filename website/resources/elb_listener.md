# ctyun_elb_listener (Resource)
**详细说明请见文档：https://www.ctyun.cn/document/10026756/10140276**



## 样例

```terraform
terraform {
  required_providers {
    ctyun = {
      source = "ctyun-it/ctyun"
    }
  }
}

# 可参考index.md，在环境变量中配置ak、sk、资源池ID、可用区名称
provider "ctyun" {
  env = "prod"
}

resource "ctyun_vpc" "vpc_test" {
  name        = "tf-vpc-for-elb"
  cidr        = "192.168.0.0/16"
  description = "terraform测试使用"
  enable_ipv6 = true
}

resource "ctyun_subnet" "subnet_test" {
  vpc_id      = ctyun_vpc.vpc_test.id
  name        = "tf-subnet-for-elb"
  cidr        = "192.168.1.0/24"
  description = "terraform测试使用"
  dns = [
    "114.114.114.114",
    "8.8.8.8",
    "8.8.4.4"
  ]
}

resource "ctyun_elb_loadbalancer" "listener_test" {
  subnet_id     = ctyun_subnet.subnet_test.id
  name          = "tf-elb-for-listener"
  sla_name      = "elb.s2.small"
  resource_type = "internal"
  vpc_id        = ctyun_vpc.vpc_test.id
  cycle_type    = "month"
  cycle_count   = 1
}

resource "ctyun_elb_target_group" "test2" {
  name      = "tf-tg-for-target2"
  vpc_id    = ctyun_vpc.vpc_test.id
  algorithm = "wrr"
}

resource "ctyun_elb_listener" "elb_listener_test" {
  loadbalancer_id     = ctyun_elb_loadbalancer.listener_test.id
  name                = "tf_elb_listener"
  protocol            = "TCP"
  protocol_port       = 12345
  default_action_type = "forward"
  target_groups = [{ target_group_id = ctyun_elb_target_group.test2.id }]
  listener_cps        = 1
  establish_timeout   = 100
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `default_action_type` (String) 默认规则动作类型。取值范围：forward、redirect，支持更新
- `loadbalancer_id` (String) 负载均衡实例ID
- `name` (String) 唯一。支持拉丁字母、中文、数字，下划线，连字符，中文 / 英文字母开头，不能以 http: / https: 开头，长度 2 - 32，支持更新
- `protocol` (String) 监听协议。取值范围：TCP、UDP、HTTP、HTTPS
- `protocol_port` (Number) 负载均衡实例监听端口。取值：1-65535，protocol_port。不支持更新

### Optional

- `access_control_id` (String) 访问控制ID，当access_control_type=white或者black，必填。支持更新
- `access_control_type` (String) 访问控制类型。取值范围：Close（未启用）、White（白名单）、Black（黑名单），支持更新
- `az_name` (String) 可用区名称
- `ca_enabled` (Boolean) 是否开启双向认证。true（开启），false（不开启），支持更新
- `certificate_id` (String) 证书ID。当protocol为HTTPS时，此参数必填，支持更新
- `client_certificate_id` (String) 双向认证的证书ID，当ca_enabled=ture，必填。支持更新
- `description` (String) 支持拉丁字母、中文、数字, 特殊字符：~!@#$%^&*()_-+= <>?:{},./;'[]·！@#￥%……&*（） —— -+={}\|《》？：“”【】、；‘'，。、，不能以 http: / https: 开头，长度 0 - 128，支持更新
- `enable_nat_64` (Boolean) 是否开启nat64，elb需要支持ipv6能力，支持更新
- `establish_timeout` (Number) 建立连接超时时间，单位秒，取值范围：1 - 1800。不支持协议为 UDP / HTTP / HTTPS 的监听器，支持更新
- `forwarded_for_enabled` (Boolean) x-forward-for功能。false（未开启）、true（开启），支持更新
- `idle_timeout` (Number) 链接空闲断开超时时间，单位秒，取值范围：1 - 300,不支持协议为 TCP / UDP 的监听器，支持更新
- `listener_cps` (Number) cps大小，仅支持协议为 TCP / UDP 的监听器。支持更新
- `listener_qps` (Number) qps 大小，仅支持协议为 HTTP / HTTPS，的监听器，支持更新
- `project_id` (String) 企业项目ID，如果不填则默认使用provider ctyun中的project_id或环境变量中的CTYUN_PROJECT_ID
- `redirect_listener_id` (String) 重定向监听器ID，当default_action_type为redirect时，此字段必填。支持更新
- `region_id` (String) 资源池Id，默认使用provider ctyun总region_id 或者环境变量
- `response_timeout` (Number) 响应超时，单位秒，取值范围：1 - 300。不支持协议为 TCP / UDP 的监听器，支持更新
- `status` (String) 监听器状态: DOWN/ACTIVE，可以控制监听器开关。支持更新
- `target_groups` (Attributes List) 后端服务组，最多只支持添加一个后端服务组。当default_action_type=forward时，target_groups不能为空。支持更新 (see [below for nested schema](#nestedatt--target_groups))

### Read-Only

- `created_time` (String) 创建时间，为UTC格式
- `id` (String) 监听器ID
- `updated_time` (String) 更新时间，为UTC格式

<a id="nestedatt--target_groups"></a>
### Nested Schema for `target_groups`

Required:

- `target_group_id` (String) 后端服务组ID，支持更新

Optional:

- `weight` (Number) 后端主机权重，取值范围：1-256。默认为100，支持更新