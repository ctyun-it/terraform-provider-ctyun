# ctyun_mongodb_instance (Resource)
**详细说明请见文档：https://www.ctyun.cn/document/10034467/10089535**



## 样例

```terraform
terraform {
  required_providers {
    ctyun = {
      source = "ctyun-it/ctyun"
    }
  }
}

# 可参考index.md，在环境变量中配置ak、sk、资源池ID、可用区名称
provider "ctyun" {

}

resource "ctyun_vpc" "vpc_test" {
  name        = "tf-vpc-for-mon"
  cidr        = "192.168.0.0/16"
  description = "terraform测试使用"
  enable_ipv6 = true
}

resource "ctyun_subnet" "subnet_test" {
  vpc_id      = ctyun_vpc.vpc_test.id
  name        = "tf-subnet-for-mon"
  cidr        = "192.168.0.0/16"
  description = "terraform测试使用"
  dns = [
    "8.8.8.8",
    "8.8.4.4"
  ]
}

resource "ctyun_security_group" "security_group_test" {
  vpc_id      = ctyun_vpc.vpc_test.id
  name        = "tf-sg-for-mon"
  description = "terraform测试使用"
  lifecycle {
    prevent_destroy = false
  }
}

resource "ctyun_mongodb_instance" "test" {
  cycle_type             = "on_demand"
  vpc_id                 = ctyun_vpc.vpc_test.id
  flavor_name            = "s7.large.2"
  subnet_id              = ctyun_subnet.subnet_test.id
  security_group_id      =  ctyun_security_group.security_group_test.id
  name                   = "mongodb-12ab"
  prod_id                = "Single34"
  storage_type           = "SATA"
  storage_space          = 100
  backup_storage_type    = "OS"
  password = var.password
}

variable "password" {
  type      = string
  sensitive = true
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `cycle_type` (String) 订购周期类型，取值范围：month：按月，on_demand：按需。当此值为month时，cycle_count为必填
- `flavor_name` (String) 规格名称，形如c7.2xlarge.4，可从data.ctyun_mongodb_specs查询支持的规格。支持更新
- `name` (String) 实例名称（长度在 4 到 64个字符，必须以字母开头，不区分大小写，可以包含字母、数字、中划线或下划线，不能包含其他特殊字符），支持更新。
- `password` (String, Sensitive) 实例密码，长度为8~26个字符，必须包含大写字母、小写字母、数字和特殊字符~!@#%^*_=+
- `prod_id` (String) 产品id，开通时用于确定开通单机/集群版/副本集和版本，支持更新。取值范围包括：Single34（3.4单机版）,Single40（4.0单机版）,Replica3R34（3.4副本集三副本）,Replica3R40（4.0副本集三副本）,Replica5R34（3.4副本集五副本）,Replica5R40（4.0副本集五副本）,Replica7R34（3.4副本集七副本）,Replica7R40（4.0副本集七副本）,Cluster34（3.4集群版）,Cluster40（4.0集群版）,Single42（4.2单机版）,Replica3R42（4.2副本集三副本）,Replica5R42（4.2副本集五副本）,Replica7R42（4.2副本集七副本）,Cluster42（4.2集群版）,Single50（5.0单机版）,Replica3R50（5.0副本集三副本）,Replica5R50（5.0副本集五副本）,Replica7R50（5.0副本集七副本）,Cluster50（5.0集群版）,Cluster60（6.0集群版）,Replica3R60（6.0副本集三副本）,Replica5R60（6.0副本集五副本）,Replica7R60（6.0副本集七副本）,Single60（6.0单机版）
- `security_group_id` (String) 安全组Id
- `subnet_id` (String) 子网Id
- `vpc_id` (String) 虚拟私有云Id

### Optional

- `auto_renew` (Boolean) 是否自动续订，默认非自动续订，当cycle_type不等于on_demand时才可填写，当cycle_count<12，到期自动续订1个月，当cycle_count>=12，到期自动续订12个月
- `availability_zone_info` (Attributes List) mongodb实例节点指定可用区字段，选填。若不填写，将按节点个数均匀分布到各个可用区上。若需要填写可参考提供的examples (see [below for nested schema](#nestedatt--availability_zone_info))
- `backup_storage_type` (String) backup节点存储类型，取值范围：SATA, SAS, SSD, OS（对象存储）。若不填写，默认为云硬盘（SSD）
- `cycle_count` (Number) 订购时长，该参数当且仅当在cycle_type为month时填写，支持传递1-36
- `is_upgrade_back_up` (Boolean) 磁盘扩容时候会使用,是否主磁盘与备磁盘一起扩容，支持更新。该参数仅在升配主存储空间时生效，且需要注意is_upgrade_back_up=ture时，待升配的磁盘空间必须大于现磁盘空间（包括备份空间）。取值范围：true-主备同时扩容； false-主备不同时扩容。默认为false
- `mongos_num` (Number) mongos节点数量，mongodb为集群版需填写，支持更新。默认为2，取值范围：2~32
- `project_id` (String) 企业项目ID，如果不填则默认使用provider ctyun中的project_id或环境变量中的CTYUN_PROJECT_ID
- `read_port` (Number) 读端口,支持更新。若需要更新读取端口时可填，取值范围：1~65535
- `region_id` (String) 区域id,如果不填这默认使用provider ctyun总region_id 或者环境变量
- `shard_num` (Number) shard节点数量，mongodb为集群版需填写，支持更新。默认为2，取值范围：2~32
- `storage_space` (Number) 存储空间(单位:G)，默认为100GB，支持更新。取值范围：10-6144，backup节点为单个shard的容量乘以shard的个数
- `storage_type` (String) 存储类型，默认为SSD。取值范围：SSD=超高IO, SAS=高IO, SATA=普通IO，SSD-genric=通用型SSD
- `upgrade_node_type` (String) 当实例为集群版，若升配mongos、shard节点个数时可填写，支持更新。取值范围：shard, mongos

### Read-Only

- `backup_storage_space` (Number) backup节点磁盘空间，当前不支持指定。默认与存储空间相同
- `eip_id` (String) eip Id
- `host_ip` (String) 主机ip
- `id` (String) mongodb实例id
- `innodb_buffer_pool_size` (String) 缓存池大小
- `innodb_thread_concurrency` (Number) 线程数
- `master_order_id` (String) 订单id
- `prod_running_status` (Number) 实例运行状态: 0->运行正常, 1->重启中, 2-备份操作中, 3->恢复操作中,4->转换ssl,5->异常,6->修改参数组中,7->已冻结,8->已注销,9->施工中,10->施工失败,11->扩容中,12->主备切换中
- `prod_running_status_desc` (String) 实例运行状态解释字段

<a id="nestedatt--availability_zone_info"></a>
### Nested Schema for `availability_zone_info`

Required:

- `availability_zone_count` (Number) 资源池可用区总数（开通集群版--nodeType为mongos时范围为[2,16]，nodeType为shard时,shard数量取值范围[2,16]，每一个shard对应3个availabilityZoneCount, 例：nodeType: shard且要开通shard数 量为3时，availabilityZoneCount:9 ；nodeType为config时节点默认为3即availabilityZoneCount: 3）
- `availability_zone_name` (String) 资源池可用区名称
- `node_type` (String) master:主节点、mongos:mongos节点、shard:shard节点 、config:config节点（存储类型storageType与shard节点一致，存储空间storageSpace为单个shard的storageSpace）、 backup:备份机(存储类型storageType与shard 节点一致，存储空间storageSpace为shard节点数量乘以单个shard的storageSpace)